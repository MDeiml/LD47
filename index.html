<!-- index.html --><!DOCTYPE html>
<html>
	<head>
		<title>LD47</title>
		<!-- Disables mobile touch delay-->
		<meta name="viewport" content="width=device-width, user-scalable=no">
		<script type="module" src="./main.js"></script>
		<script id="shader-vs" type="x-shader/x-vertex">
			attribute vec3 position;
			attribute vec2 texCoord;

			varying mediump vec2 vTexCoord;
			varying mediump vec3 worldPos;

			uniform mat4 M;
			uniform mat4 VP;
			uniform vec2 frame_data;

			void main(void) {
				vTexCoord = vec2((texCoord.x * (1.0/frame_data.y)) + (frame_data.x/frame_data.y), texCoord.y);
				worldPos = (M * vec4(position, 1.0)).xyz;
				gl_Position = VP * vec4(worldPos, 1.0);
			}
		</script>
		<script id="shader-fs" type="x-shader/x-fragment">
			precision mediump float;
			
			varying mediump vec2 vTexCoord;
			varying mediump vec3 worldPos;

			uniform sampler2D texture;

			void main(void) {
				gl_FragColor = texture2D(texture, vTexCoord);
			}
		</script>
		
		<script id="blur-vs" type="x-shader/x-vertex">
			attribute vec3 position;
			attribute vec2 texCoord;

			varying mediump vec2 vTexCoord;
			varying mediump vec3 worldPos;

			uniform mat4 M;
			uniform mat4 VP;
			uniform vec2 frame_data;

			void main(void) {
				vTexCoord = vec2((texCoord.x * (1.0/frame_data.y)) + (frame_data.x/frame_data.y), texCoord.y);
				worldPos = (M * vec4(position, 1.0)).xyz;
				gl_Position = VP * vec4(worldPos, 1.0);
			}
		</script>
		<script id="blur-fs" type="x-shader/x-fragment">
			precision mediump float;
			
			varying mediump vec2 vTexCoord;
			varying mediump vec3 worldPos;

			uniform sampler2D texture;
			uniform vec2 texRes;
			
			vec4 getTexFromOffset(float x, float y) {
				return texture2D(texture, vec2( vTexCoord.x + (x * 2.0)/texRes.x, vTexCoord.y + (y * 2.0)/texRes.y));
			}
			
			void main(void) {
				vec4 color = 0.00000067 * (getTexFromOffset(-3.0, -3.0) + getTexFromOffset(3.0, -3.0) + getTexFromOffset(-3.0, 3.0) + getTexFromOffset(3.0, 3.0));
				color += 0.00002292 * (getTexFromOffset(-2.0, -3.0) + getTexFromOffset(2.0, -3.0) + getTexFromOffset(-2.0, 3.0) + getTexFromOffset(2.0, 3.0) + getTexFromOffset(-3.0, -2.0) + getTexFromOffset(3.0, -2.0) + getTexFromOffset(-3.0, 2.0) + getTexFromOffset(3.0, 2.0));
				color += 0.00019117 * (getTexFromOffset(-1.0, -3.0) + getTexFromOffset(1.0, -3.0) + getTexFromOffset(-1.0, 3.0) + getTexFromOffset(1.0, 3.0) + getTexFromOffset(-3.0, -1.0) + getTexFromOffset(3.0, -1.0) + getTexFromOffset(-3.0, 1.0) + getTexFromOffset(3.0, 1.0));
				color += 0.00038771 * (getTexFromOffset( 0.0, -3.0) + getTexFromOffset(3.0, 0.0) + getTexFromOffset(-3.0, 0.0) + getTexFromOffset(0.0, 3.0));
				
				color += 0.00078633 * (getTexFromOffset(-2.0, -2.0) + getTexFromOffset(2.0, -2.0) + getTexFromOffset(-2.0, 2.0) + getTexFromOffset(2.0, 2.0));
				color += 0.00655965 * (getTexFromOffset(-1.0, -2.0) + getTexFromOffset(1.0, -2.0) + getTexFromOffset(-1.0, 2.0) + getTexFromOffset(1.0, 2.0) + getTexFromOffset(-2.0, -1.0) + getTexFromOffset(2.0, -1.0) + getTexFromOffset(-2.0, 1.0) + getTexFromOffset(2.0, 1.0));
				color += 0.01330373 * (getTexFromOffset( 0.0, -2.0) + getTexFromOffset(2.0, 0.0) + getTexFromOffset(-2.0, 0.0) + getTexFromOffset(0.0, 2.0));
				
				color += 0.05472157 * (getTexFromOffset(-1.0, -1.0) + getTexFromOffset(1.0, -1.0) + getTexFromOffset(-1.0, 1.0) + getTexFromOffset(1.0, 1.0));
				color += 0.11098164 * (getTexFromOffset(-1.0, 0.0) + getTexFromOffset(1.0, 0.0) + getTexFromOffset(0.0, 1.0) + getTexFromOffset(0.0, -1.0));
				
				color += 0.22508352 * (getTexFromOffset(0.0, 0.0));
				
				gl_FragColor = color;
			}
		</script>
		
		<style>
			* {
				margin: 0;
				padding: 0;
			}
			body, html { height: 100% }
			canvas {
				position: absolute;
				width: 100%;
				height: 100%;
			}
		</style>
		<link rel="shortcut icon" href="https://raw.githubusercontent.com/MDeiml/LD46/master/favicon.ico" type="image/x-icon">
		<link rel="icon" href="https://raw.githubusercontent.com/MDeiml/LD46/master/favicon.ico" type="image/x-icon">
	</head>

	<body>
		<canvas id="glCanvas" width="800" height="600"></canvas>
	</body>
</html>
